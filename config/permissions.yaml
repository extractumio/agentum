# Permission profile for Agentum agent.
# Loaded once at startup and used throughout execution.
# Session-specific permissions are generated dynamically using {workspace} placeholder.
# Agent is sandboxed to its workspace with limited bash access.

name: user
description: User profile for task execution. Session-specific permissions are generated dynamically.
defaultMode: default

tools:
  enabled:
    - Read
    - Edit
    - MultiEdit
    - Task
    - Skill
    - TodoRead
    - TodoWrite
    - Glob
    - Grep
    - LS
    - WebFetch
    - WebSearch
    - NotebookEdit
    - Write
    - Bash
  disabled:
  permission_checked:
    - Read
    - Write
    - Edit
    - MultiEdit
    - Bash

session_workspace:
  description: Patterns for session-specific workspace permissions.
  allow:
    # Session workspace access (output.yaml, results, etc.)
    - Read({workspace}/**)
    - Write({workspace}/**)
    - Edit({workspace}/**)
    - MultiEdit({workspace}/**)
    # Relative paths from cwd (which is set to workspace)
    - Read(./**)
    - Write(./**)
    - Edit(./**)
    - MultiEdit(./**)
    # Skills directory read access
    - Read({workspace}/skills/**)
    - Read(./skills/**)
    # Only allow running pre-approved skill scripts
    - Bash(python {workspace}/skills/**/*.py)
    - Bash(python3 {workspace}/skills/**/*.py)
    - Bash(python ./skills/**/*.py)
    - Bash(python3 ./skills/**/*.py)
    - Task
    - Skill
    - TodoRead
    - TodoWrite
  deny:
    # Skills directory is READ-ONLY (prevent code injection)
    - Write({workspace}/skills/**)
    - Edit({workspace}/skills/**)
    - MultiEdit({workspace}/skills/**)
    - Write(./skills/**)
    - Edit(./skills/**)
    - MultiEdit(./skills/**)
    # Block all other bash commands
    - Bash(*)
    - Glob(*)
    - Grep(*)
    - LS(*)
  allowed_dirs:
    - "{workspace}"
    - "{workspace}/skills"

# Sandbox configuration (bubblewrap). Toggle for non-docker runs as needed.
sandbox:
  enabled: true
  file_sandboxing: true
  network_sandboxing: true
  bwrap_path: "bwrap"
  use_tmpfs_root: true
  static_mounts:
    skills:
      source: "{agent_dir}/skills"
      target: "/skills"
      mode: ro
    system_usr:
      source: "/usr"
      target: "/usr"
      mode: ro
    system_lib:
      source: "/lib"
      target: "/lib"
      mode: ro
    system_lib64:
      source: "/lib64"
      target: "/lib64"
      mode: ro
    system_bin:
      source: "/bin"
      target: "/bin"
      mode: ro
  session_mounts:
    workspace:
      source: "{workspace_dir}"
      target: "/workspace"
      mode: rw
  dynamic_mounts: []
  network:
    enabled: false
    allowed_domains: []
    allow_localhost: false
  environment:
    home: "/workspace"
    path: "/usr/bin:/bin"
    clear_env: true
  writable_paths:
    - "/workspace"
  readonly_paths:
    - "/skills"
    - "/usr"
    - "/lib"
    - "/lib64"
    - "/bin"

# File checkpointing configuration
checkpointing:
  # Tools that trigger automatic checkpoint creation after execution
  auto_checkpoint_tools:
    - Write
    - Edit
    - MultiEdit
